<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dopes Fitness - Pay Now</title>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; color: #333; text-align: center; padding: 60px 20px;}
    .btn { padding: 14px 32px; background: #111; color: #fff; border-radius: 5px; border: none; font-size: 1.2em; cursor: pointer;}
    .btn:hover { background: #444;}
  </style>
</head>
<body>
  <h1>Subscribe & Pay</h1>
  <p>Get started with Dopes Fitness subscription!</p>
  <button class="btn" id="payBtn">Pay ₹10</button>
  <script>
    document.getElementById('payBtn').onclick = async function(e) {
      // Step 1: Create order via backend
      const response = await fetch("https://fitness-app-rl7q.onrender.com/create-order", { method: "POST" });
      const order = await response.json();

      // Step 2: Open Razorpay Checkout
      const options = {
        key: "rzp_live_RKB5wpngUC57hu", // Your actual Razorpay LIVE Key ID
        amount: order.amount,
        currency: order.currency,
        name: "Dopes Fitness",
        description: "Subscription Payment",
        order_id: order.id, // <-- This is crucial!
        handler: function (response) {
          // Optionally verify payment for security
          fetch("https://fitness-app-rl7q.onrender.com/verify-payment", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(response)
          })
          .then(res => res.json())
          .then(data => {
            if (data.success) {
              alert("✅ Payment Verified and Auto-Captured!");
            } else {
              alert("⚠️ Payment Verification Failed!");
            }
          });
        }
      };
      const rzp1 = new Razorpay(options);
      rzp1.open();
      e.preventDefault();
    }
  </script>
</body>
</html>
